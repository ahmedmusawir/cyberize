{"version":3,"sources":["d3-donut-graph.min.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","_extends","Object","assign","target","arguments","source","key","prototype","hasOwnProperty","dims","cent","svg","d3","select","append","attr","graph","pie","sort","value","d","cost","arcPath","arc","outerRadius","innerRadius","color","scaleOrdinal","legendGroup","legend","legendColor","shape","shapePadding","scale","tip","html","content","data","name","db","collection","onSnapshot","res","docChanges","forEach","change","doc","id","type","push","index","findIndex","item","filter","domain","map","selectAll","paths","exit","transition","duration","attrTween","arcTweenExit","remove","arcTweenUpdate","enter","each","this","_current","arcTweenEnter","on","show","handleMouseOver","hide","handleMouseOut","handleClick","update","interpolate","endAngle","startAngle","delete"],"mappings":"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","file":"d3-donut-graph.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n'use strict';\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar dims = { height: 180, width: 300, radius: 150 };\nvar cent = { x: dims.width / 2 + 5, y: dims.height / 2 + 70 };\n\nvar svg = d3.select('.canvas').append('svg').attr('width', dims.width + 150).attr('height', dims.height + 150);\n\nvar graph = svg.append('g').attr('transform', 'translate(' + cent.x + ', ' + cent.y + ')');\n\nvar pie = d3.pie().sort(null).value(function (d) {\n  return d.cost;\n});\n\n// STATIC DATA\n// const angles = pie([\n//   { name: 'rent', cost: 500 },\n//   { name: 'bills', cost: 300 },\n//   { name: 'gaming', cost: 200 }\n// ]);\n\nvar arcPath = d3.arc().outerRadius(dims.radius).innerRadius(dims.radius / 2);\n\n// COLORS\nvar color = d3.scaleOrdinal(d3['schemeSet3']);\n\n// LEGEND SETUP\nvar legendGroup = svg.append('g').attr('transform', 'translate(' + (dims.width + 30) + ', 10)');\n\nvar legend = d3.legendColor().shape('circle').shapePadding(10).scale(color);\n\n// TOOL TIP SETUP\nvar tip = d3.tip().attr('class', 'tip card').html(function (d) {\n  var content = '<div class=\"name\">' + d.data.name + '</div>';\n  content += '<div class=\"cost\">' + d.data.cost + '</div>';\n  content += '<div class=\"delete\">Click slice to delete</div>';\n  return content;\n});\n\ngraph.call(tip);\n\n// UPDATE FUNCTION\nvar update = function update(data) {\n  // UPDATE COLOR SCALE DOMAIN\n  color.domain(data.map(function (d) {\n    return d.name;\n  }));\n\n  // UPDATE AND CAL LEGEND\n  legendGroup.call(legend);\n  legendGroup.selectAll('text').attr('fill', 'white');\n\n  // JOIN ENHANCED (PIE) DATA TO PATH ELEMENTS\n  var paths = graph.selectAll('path').data(pie(data));\n\n  // HANDLE EXIT SELECTION\n  paths.exit().transition().duration(750).attrTween('d', arcTweenExit).remove();\n\n  // HANDLE THE CURRENT DOM PATH UPDATES\n  paths.attr('d', arcPath).transition().duration(750).attrTween('d', arcTweenUpdate);\n\n  // console.log(paths.enter());\n  paths.enter().append('path').attr('class', 'arc').attr('stroke', '#fff').attr('stroke-width', 3).attr('fill', function (d) {\n    return color(d.data.name);\n  }).each(function (d) {\n    this._current = d;\n  }).transition().duration(750).attrTween('d', arcTweenEnter);\n\n  // ADD EVENTS\n  graph.selectAll('path').on('mouseover', function (d, i, n) {\n    tip.show(d, n[i]);\n    handleMouseOver(d, i, n);\n  }).on('mouseout', function (d, i, n) {\n    tip.hide();\n    handleMouseOut(d, i, n);\n  }).on('click', handleClick);\n};\n\n// FIREBASE ACCESS - ON SNAPSHOT\nvar data = [];\n\ndb.collection('expenses').onSnapshot(function (res) {\n  res.docChanges().forEach(function (change) {\n    var doc = _extends({}, change.doc.data(), { id: change.doc.id });\n    switch (change.type) {\n      case 'added':\n        data.push(doc);\n        break;\n      case 'modified':\n        var index = data.findIndex(function (item) {\n          return item.id == doc.id;\n        });\n        data[index] = doc;\n        break;\n      case 'removed':\n        data = data.filter(function (item) {\n          return item.id !== doc.id;\n        });\n        break;\n      default:\n        break;\n    }\n  });\n\n  update(data);\n});\n\nvar arcTweenEnter = function arcTweenEnter(d) {\n  var i = d3.interpolate(d.endAngle, d.startAngle);\n\n  return function (t) {\n    d.startAngle = i(t);\n    return arcPath(d);\n  };\n};\n\nvar arcTweenExit = function arcTweenExit(d) {\n  var i = d3.interpolate(d.startAngle, d.endAngle);\n\n  return function (t) {\n    d.startAngle = i(t);\n    return arcPath(d);\n  };\n};\n\n// USE FUNCTION KEYWORD TO USE 'THIS' KEY WORD\nfunction arcTweenUpdate(d) {\n  // INTERPOLATE BETWEEN THIS 2 OBJECTS\n  var i = d3.interpolate(this._current, d);\n\n  // UPDATE THE CURRENT PROP WITH NEW UPDATED DATA\n  this._current = d;\n\n  return function (t) {\n    return arcPath(i(t));\n  };\n}\n\n// EVENT HANDLERS\nvar handleMouseOver = function handleMouseOver(d, i, n) {\n  // console.log(n[i]);\n  d3.select(n[i]).transition('changeSliceFill').duration(500).attr('fill', '#000');\n};\n\nvar handleMouseOut = function handleMouseOut(d, i, n) {\n  // console.log(n[i]);\n  d3.select(n[i]).transition('changeSliceFill').duration(500).attr('fill', color(d.data.name));\n};\n\nvar handleClick = function handleClick(d) {\n  // console.log(d);\n  var id = d.data.id;\n  db.collection('expenses').doc(id).delete();\n};\n\n},{}]},{},[1]);\n"]}